{% extends "GGshopping.html" %}
{% load static %}

{% block content %}
<div class="login-container">
  <h2>LINE 登入中，請稍候...</h2>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(window.location.search);
  const token = params.get("token");

  if (!token) {
    alert("LINE 登入失敗，缺少 token");
    window.location.href = "/login/";
    return;
  }

  firebase.auth().signInWithCustomToken(token)
    .then(() => {
      window.location.href = "/";
    })
    .catch(err => {
      alert("LINE 登入失敗：" + err.message);
      window.location.href = "/login/";
    });
});
</script>
{% endblock %}
